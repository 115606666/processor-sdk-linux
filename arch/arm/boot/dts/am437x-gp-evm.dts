/*
 * Copyright (C) 2013 Texas Instruments Incorporated - http://www.ti.com/
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

/* AM437x GP EVM */

/dts-v1/;

#include "am43x-common-evm.dtsi"
#include <dt-bindings/pinctrl/am43xx.h>

/ {
	model = "TI AM437x gp EVM";
	compatible = "ti,am437x-gp-evm","ti,am4372","ti,am43";

	cpus {
		cpu@0 {
			cpu0-supply = <&dcdc2>;
		};
	};
};

&am43xx_pinmux {
	pinctrl-names = "default";
	pinctrl-0 = <&ddr3_vtt_toggle_default>;

	ddr3_vtt_toggle_default: ddr_vtt_toggle_default {
		pinctrl-single,pins = <
			0x25C (DS0_PULL_UP_DOWN_EN | PIN_OUTPUT_PULLUP | DS0_FORCE_OFF_MODE | MUX_MODE7) /* spi0_cs0.gpio5_7 */
		>;
	};

	i2c0_pins: pinmux_i2c0_pins {
		pinctrl-single,pins = <
			0x188 (PIN_INPUT_PULLUP | SLEWCTRL_FAST | MUX_MODE0)    /* i2c0_sda.i2c0_sda */
			0x18c (PIN_INPUT_PULLUP | SLEWCTRL_FAST | MUX_MODE0)    /* i2c0_scl.i2c0_scl */
		>;
	};
};

&i2c0 {
        status = "okay";
        pinctrl-names = "default";
        pinctrl-0 = <&i2c0_pins>;
	clock-frequency = <400000>;

	/* Set OPP50 (0.95V) for VDD MPU and core */
	sleep-sequence = /bits/ 8 <
		0x02 0x24 0x10 0x6b /* Password unlock 1 */
		0x02 0x24 0x16 0x8A /* Set DCDC1 (Core) to 0.95V */
		0x02 0x24 0x10 0x67 /* Password unlock 3 */
		0x02 0x24 0x1A 0x86 /* Apply DCDC changes */
	>;

	/* Set OPP100 (1.10V) for VDD core */
	wake-sequence = /bits/ 8 <
		0x02 0x24 0x10 0x6B /* Password unlock 2 */
		0x02 0x24 0x16 0x99 /* Set DCDC1 (Core) to 1.1V */
		0x02 0x24 0x10 0x67 /* Password unlock 3 */
		0x02 0x24 0x1A 0x86 /* Apply DCDC changes */
	>;

	tps65218: tps65218@24 {
		reg = <0x24>;
		compatible = "ti,tps65218";
		interrupts = <GIC_SPI 7 IRQ_TYPE_NONE>; /* NMIn */
		interrupt-parent = <&gic>;
		interrupt-controller;
		#interrupt-cells = <2>;

		dcdc1: regulator-dcdc1 {
			compatible = "ti,tps65218-dcdc1";
			/* VDD_CORE voltage limits min of OPP50 and max of OPP100 */
			regulator-name = "vdd_core";
			regulator-min-microvolt = <912000>;
			regulator-max-microvolt = <1144000>;
			regulator-boot-on;
			regulator-always-on;
		};

		dcdc2: regulator-dcdc2 {
			compatible = "ti,tps65218-dcdc2";
			/* VDD_MPU voltage limits min of OPP50 and max of OPP_NITRO */
			regulator-name = "vdd_mpu";
			regulator-min-microvolt = <912000>;
			regulator-max-microvolt = <1378000>;
			regulator-boot-on;
			regulator-always-on;
		};

		dcdc3: regulator-dcdc3 {
			compatible = "ti,tps65218-dcdc3";
		};

		ldo1: regulator-ldo1 {
			compatible = "ti,tps65218-ldo1";
			regulator-min-microvolt = <1800000>;
			regulator-max-microvolt = <1800000>;
			regulator-boot-on;
			regulator-always-on;
		};
	};
};

&rtc {
	status = "okay";
};

&gpio5 {
	status = "okay";
	ti,no-reset;
};

&wkup_m3 {
	ti,set-io-isolation;
};
